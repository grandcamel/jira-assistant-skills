metadata:
  name: jira-assistant-skills-e2e
  description: E2E tests for JIRA Assistant Skills plugin
  version: 1.0.0
  generated_from: plugins/jira-assistant-skills

settings:
  default_timeout: 120
  default_model: claude-sonnet-4-20250514
  retry_on_timeout: 1
  plugin_path: plugins/jira-assistant-skills

suites:
  plugin_installation:
    description: Plugin installation and verification
    tests:
      - id: install_plugin
        name: Install plugin from local source
        prompt: /plugin plugins/jira-assistant-skills
        expect:
          success: true
          no_errors: true

      - id: verify_all_skills
        name: Verify all 14 skills are loaded
        prompt: List all available JIRA skills from the jira-assistant-skills plugin
        expect:
          success: true
          output_contains_any:
            - jira-issue
            - jira-search
            - jira-agile
          no_errors: true

  jira_issue:
    description: Tests for jira-issue skill - core CRUD operations
    tests:
      - id: discover_skill
        name: Verify jira-issue skill is discoverable
        prompt: What can you do with JIRA issues? Can you create, update, or delete them?
        expect:
          output_contains_any:
            - create
            - update
            - issue
            - JIRA
          no_errors: true

      - id: get_issue_help
        name: Test issue retrieval help
        prompt: How do I get details for a specific JIRA issue?
        expect:
          output_contains_any:
            - jira issue get
            - issue key
            - PROJ-123
          no_crashes: true

      - id: create_issue_help
        name: Test issue creation help
        prompt: How do I create a new bug in JIRA?
        expect:
          output_contains_any:
            - jira issue create
            - --type Bug
            - --project
          no_crashes: true

  jira_search:
    description: Tests for jira-search skill - JQL queries
    tests:
      - id: discover_skill
        name: Verify jira-search skill is discoverable
        prompt: How can I search for JIRA issues? What is JQL?
        expect:
          output_contains_any:
            - JQL
            - search
            - query
          no_errors: true

      - id: jql_examples
        name: Test JQL query examples
        prompt: Give me examples of JQL queries to find issues
        expect:
          output_contains_any:
            - assignee
            - project =
            - status
          no_crashes: true

      - id: filter_help
        name: Test saved filter operations
        prompt: How do I create and run saved filters in JIRA?
        expect:
          output_contains_any:
            - filter
            - jira search filter
            - saved filter
          no_crashes: true

  jira_agile:
    description: Tests for jira-agile skill - Agile/Scrum workflows
    tests:
      - id: discover_skill
        name: Verify jira-agile skill is discoverable
        prompt: What Agile features are available? Can you manage sprints and epics?
        expect:
          output_contains_any:
            - sprint
            - epic
            - agile
            - story point
          no_errors: true

      - id: sprint_management
        name: Test sprint management guidance
        prompt: How do I create a new sprint and move issues into it?
        expect:
          output_contains_any:
            - jira agile sprint
            - sprint create
            - board
          no_crashes: true

      - id: epic_management
        name: Test epic management guidance
        prompt: How do I create an epic and add issues to it?
        expect:
          output_contains_any:
            - jira agile epic
            - epic create
            - Epic Name
          no_crashes: true

  jira_lifecycle:
    description: Tests for jira-lifecycle skill - workflow transitions
    tests:
      - id: discover_skill
        name: Verify jira-lifecycle skill is discoverable
        prompt: How do I transition JIRA issues through workflow states?
        expect:
          output_contains_any:
            - transition
            - workflow
            - status
          no_errors: true

      - id: transition_help
        name: Test transition guidance
        prompt: How do I move an issue from In Progress to Done?
        expect:
          output_contains_any:
            - transition
            - Done
            - status
          no_crashes: true

  jira_collaborate:
    description: Tests for jira-collaborate skill - comments and attachments
    tests:
      - id: discover_skill
        name: Verify jira-collaborate skill is discoverable
        prompt: How can I add comments or attachments to JIRA issues?
        expect:
          output_contains_any:
            - comment
            - attachment
            - watcher
          no_errors: true

      - id: comment_help
        name: Test comment operations
        prompt: How do I add a comment to an issue with markdown formatting?
        expect:
          output_contains_any:
            - jira collaborate comment
            - comment add
            - markdown
          no_crashes: true

  jira_relationships:
    description: Tests for jira-relationships skill - issue linking
    tests:
      - id: discover_skill
        name: Verify jira-relationships skill is discoverable
        prompt: How do I link related JIRA issues together?
        expect:
          output_contains_any:
            - link
            - blocks
            - relationship
          no_errors: true

      - id: blocker_help
        name: Test blocker chain analysis
        prompt: How can I find all issues blocking a specific issue?
        expect:
          output_contains_any:
            - blocker
            - chain
            - dependency
          no_crashes: true

  jira_time:
    description: Tests for jira-time skill - time tracking
    tests:
      - id: discover_skill
        name: Verify jira-time skill is discoverable
        prompt: How do I track time and log work on JIRA issues?
        expect:
          output_contains_any:
            - worklog
            - time
            - estimate
          no_errors: true

      - id: worklog_help
        name: Test worklog operations
        prompt: How do I log 2 hours of work on an issue?
        expect:
          output_contains_any:
            - jira time log
            - time log
            - 2h
          no_crashes: true

  jira_jsm:
    description: Tests for jira-jsm skill - Jira Service Management
    tests:
      - id: discover_skill
        name: Verify jira-jsm skill is discoverable
        prompt: What Jira Service Management features are available?
        expect:
          output_contains_any:
            - service desk
            - request
            - SLA
            - queue
          no_errors: true

      - id: request_help
        name: Test request operations
        prompt: How do I create a new service request?
        expect:
          output_contains_any:
            - request
            - service desk
            - customer
          no_crashes: true

  jira_bulk:
    description: Tests for jira-bulk skill - bulk operations
    tests:
      - id: discover_skill
        name: Verify jira-bulk skill is discoverable
        prompt: How can I perform bulk operations on multiple JIRA issues?
        expect:
          output_contains_any:
            - bulk
            - multiple
            - batch
          no_errors: true

      - id: bulk_transition_help
        name: Test bulk transition guidance
        prompt: How do I transition 50 issues to Done at once?
        expect:
          output_contains_any:
            - bulk
            - transition
            - dry-run
          no_crashes: true

  jira_dev:
    description: Tests for jira-dev skill - developer workflows
    tests:
      - id: discover_skill
        name: Verify jira-dev skill is discoverable
        prompt: How can I integrate JIRA with Git and pull requests?
        expect:
          output_contains_any:
            - git
            - branch
            - commit
            - PR
          no_errors: true

      - id: branch_help
        name: Test branch name generation
        prompt: Generate a git branch name for issue PROJ-123
        expect:
          output_contains_any:
            - branch
            - PROJ-123
          no_crashes: true

  jira_fields:
    description: Tests for jira-fields skill - custom field management
    tests:
      - id: discover_skill
        name: Verify jira-fields skill is discoverable
        prompt: How can I find custom field IDs in my JIRA instance?
        expect:
          output_contains_any:
            - field
            - custom
            - discover
          no_errors: true

      - id: agile_fields_help
        name: Test Agile field discovery
        prompt: How do I find the story points field ID for my project?
        expect:
          output_contains_any:
            - story point
            - customfield
            - field
          no_crashes: true

  jira_ops:
    description: Tests for jira-ops skill - operational utilities
    tests:
      - id: discover_skill
        name: Verify jira-ops skill is discoverable
        prompt: What operational utilities are available for JIRA?
        expect:
          output_contains_any:
            - cache
            - batch
            - performance
          no_errors: true

      - id: cache_help
        name: Test cache operations
        prompt: How do I warm up the JIRA cache for better performance?
        expect:
          output_contains_any:
            - cache
            - warm
          no_crashes: true

  jira_admin:
    description: Tests for jira-admin skill - admin operations
    tests:
      - id: discover_skill
        name: Verify jira-admin skill is discoverable
        prompt: What JIRA admin capabilities are available?
        expect:
          output_contains_any:
            - admin
            - project
            - permission
          no_errors: true

  error_handling:
    description: Error handling and edge cases
    tests:
      - id: invalid_issue_key
        name: Handle invalid issue key gracefully
        prompt: Get details for issue INVALID
        expect:
          no_crashes: true
          output_contains_any:
            - invalid
            - format
            - PROJ-123

      - id: missing_credentials
        name: Handle missing credentials gracefully
        prompt: What happens if JIRA credentials are not configured?
        expect:
          no_crashes: true
          output_contains_any:
            - credential
            - token
            - configure

      - id: invalid_jql
        name: Handle invalid JQL gracefully
        prompt: What happens if I run an invalid JQL query?
        expect:
          no_crashes: true
          output_contains_any:
            - JQL
            - syntax
            - validate

  integration:
    description: Cross-skill integration tests
    tests:
      - id: search_and_update
        name: Test search to update workflow
        prompt: How would I find all bugs assigned to me and update their priority?
        expect:
          output_contains_any:
            - jira search
            - jira issue update
            - assignee
          no_crashes: true

      - id: epic_to_sprint
        name: Test epic to sprint workflow
        prompt: How do I move all issues from an epic to a sprint?
        expect:
          output_contains_any:
            - epic
            - sprint
            - move
          no_crashes: true
